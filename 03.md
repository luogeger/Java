↑ ↓ ← → ↖ ↗ ↙ ↘
# 0301

## 一、	SQL分类

1.  DDL 
   - 数据库定义语言 `Data Definition Language` ，用来定义数据库对象
   - create , drop , alter, truncate
2.  DML
   - 数据操纵语言 `Data Manipulation Language` ，数据表中更新、增加、删除记录
   - update , insert , delete
3.  DCL
   - 数据控制语言 `Data Contrlol Language` ，设置用户权限和控制事务
   - grant , revoke , begin transaction
4.  DQL
   - 数据查询语言 `Data Query Language` ，记录的查询
   - select ...



## 二、	SQL语句	

### 1.  数据库的介绍、安装、卸载

- 连接数据库     `mysql -h root -p`
- 连接其他数据库 `mysql -h userIP -P userPORT -u root -p`

### 2.  数据库的操作

- 退出            `exit;`
- 查询所有DB       `show databases;`
- 创建DB          `create databese <first> charscter set utf8`
- 查看DB编码       `show create database <first>`
- 修改DB编码      `alter database <first> character set utf8`
- 删除DB         `drop database <first>`
- 查看当前使用DB   `select database()`
- 切换DB         `use <first>`

### 3.  表的操作

- 查看所有表     `show tables`
- 查看表结构     `desc <tableName>`
- 创建表        `create table <tableName>(name varchar(10),pwd varchar(16),age int(2),tel char(11) );`
- 修改表名      `rename table <oldName> to <newName>`
- 删除表        `drop table <tableName>` **表不存在了**
- 删除表再新建    `truncate <tableName>` **清空**
- 查看表编码     `show create table <tableName>`
- 修改表编码     `alter table <tableName> character set <utf8>`
- 增加字段       `alter table <tableName> add <fileName> <type>(length)`
- 删除字段       `alter table <tableName> drop <filedName>`
- 字段约束
    - 主键  `PRIMARY KEY`   
    - 自增长 `AUTO_INCREMENT`
    - 唯一  `UNIQUE`
    - 非空  `NOT NULL`
- 字段(名字、类型、长度、约束)的添加和修改，都相当于是重写 
    - `alter table <tableName> modify id int(11) auto_increment;`

### 4.  数据的操作(insert, delete, update)

- 查看表数据             `select* from <tableName>`
- 插入数据(指定字段)      `insert into <tableName> (id, name) values (null, 'jim')`
- 插入数据(省略所有字段名) `insert into person values (null, 'luogeger', '522933', '186...', 'China')`
- 修改字段值(where)      `update <tableName> set pwd='123456'` => 所有记录的字段值都被修改成123456
    - `update <tableName> set pwd='522933' where id=2`
- 删除记录(where)        `delete from <tbaleName> where id=2;`
- 删除表中所有记录        `delete from <tableName>` **表清空了**

### 5.  查询语法    
- `null` 不参与运算

- 运算符
    - `<> !=` 不相等 
    - `and` =>         `select name, age from person where age = 23 and name = 'lisi';`
    - `between and` => `select name, score from person where score between 81 and 93;`
    - `in` => 指定值中任意取值 `where age in (val1, val2, val3)`
    - `or` =>               `where age = val1 or age = val2 or age = val3`

- 模糊查询 
    - `like '%刘%'`, 只要有刘就可以, => `%` => 表示任意个数的字符： >=0
    - `like '%刘‘` , 结尾
    - `like '刘%‘`, 开始
    - `like '_刘_`, 前后只能有一个， `where name like '_刘_'`
    - `like '_刘`
    - `like '刘_`
    - `is null`         `where birthday is null`
    - `is not null`     `where name is not null`

- 过滤重复  
    - `distinct` => `select distinct age from person`, => 显示不重复的年龄

- 结果排序  
    - `order by` 对结果进行排序，默认是升序，=> `asc` 
    - `null`  在排序是最小的
    - `select * from person order by age asc`
    - `select * from person order by age dasc`

- 起别名  
    - `as` , 也可以省略
    - `select name as 姓名, age as 年龄 from person;`

### 6.  SQL聚合函数

- count
    - 统计多少条记录, `null` 不参与统计
    - `select count(name) from person`
    - `select count(name) from person where age > 18`

- sum
    - 多列求和, `null` 不参与计算 
        - `select sum(score) from students`
    - `ifnull (列值，整体返回值)`  
        - `select sum( ifnull(score, 0)) from students` : 如果分数为 null, 提供默认值0
    - `truncate (数值，保留位数)`
        - `select truncate(sum(score), 2) from students`

- avg
    - 平均数 `select avg(score) / count(*) from students`

- max, min
    - `null` 不参与计算
    - `select max(score) 最高分, min(score) 最低分 from students;`
- group by 
    - `select product, sum(price) from shoppingcart group by product`
    - `having`
        - `select product, sum(price) from shoppingcart group by product having sum(price) > 10;`
        - `having` 是在分组之后进行过滤，`where`是在分组之前进行过滤，
- 查询的执行顺序：
    1.  `from`     = 表名     
    2.  `where`    = 条件过滤  
    3.  `group by` = 分组              
    4.  `having`   = 分组之后进行过滤          
    5.  `select`   = 执行完毕之后显示内容          
    6.  `order by` = 把内容进行排序输出          

### 7.  MYSQL备份和恢复

### 8.  多表设计

- 外键约束
    - `foreign key(<currentFiled>) reference(<foreignFiled>)` , 约束从表，保证数据有效性， 
    - 已经存在的表添加外键约束
        - `alter table coder_project add foreign key(coder_id) references (id);`
    - 新建表的时候添加外键约束
        ``` 
        create table coder_project (
            coder_id int,
            project_id int,
            foreign key (coder_id) references coder(id),
            foreign key (project_id) references project(id)
        );
        ```
    - 删除：先删从表，再删主表
    - 添加：

### 9.  数据库设计

- 范式
    - 原子性，不可拆分
    - 完全依赖主键    
    - 不产生传递依赖

### 10. 多表查询

- 避免笛卡尔积 => 内连接
    - 隐式 `select * from a,b where a.id = b.id;`
    - 显示 `select * from a inner join b on a.id = b.id;`        

- 外连接
    - 左外连接  `select * from a left outer join b on a.id = b.id`
    - 右外连接  `select * from a right outer join b on a.id = b.id;`
    - 全外连接： 不去掉重复 => `union all`
    ``` 
    select * from a left outer join b  on a.id = b.id
    union
    select * from a right outer join b on a.id = b.id;
    ```

### 11. 关联子查询

- `in`
``` mysql
select * from student
where id in (
    select student_id
    from studentcourse
    where score <= 60);
```

- `exists`

- `all`

- `any`  `some`

- `as`

- `limit`


### 12. MYSQL自带函数

- 获取当前系统时间 `select now()`

- alter table <> drop foreign key (field) 


# JDBC

- java database connection
- JDBC有关的类和接口：``java.sql`` , ``javax.sql`` (扩展包)  

## 1.快速入门
```java
public class Ajdbc {
    @Test
    public void main (){
        // 1.  注册数据库驱动
        // 2.  获取数据库连接
        // 3.  创建发送SQL对象
        // 4.  执行SQL语句，获取结果
        // 5.  遍历结果集
        // 6.  关闭资源
        String url = "jdbc:mysql://localhost:3306/fourth";
        String user = "root";
        String pwd = "123456";
        String sql = "select * from user";

        DriverManager.registerDriver(new Driver());
        Connection conn = DriverManager.getConnection(url, user, pwd);
        Statement stt = conn.createStatement();
        ResultSet result = stt.executeQuery(sql);

        while (result.next()) {
            int id = result.getInt("id");
            String _user = result.getString("username");
            String _pwd = result.getString("password");

            System.out.println(id + " -> " + _user + " -> " + _pwd);
        }

        result.close();
        stt.close();
        conn.close();
    }// main
}

```

## 2.API详解

```
DriverManager → Connection → Statement → ResrltSet
                                 ↑ PreparedStatement ← CallableStatement
```

- `DriverManager`   驱动管理类
- `Connection`      数据库连接接口
- `Statement`       发送SQL语句
- `Result`          获取结果
- `PrearedStatement`    发送预编译的SQL语句到数据库
- `CallableStatement`   操作存储过程







## 3.CRUD操作

## 4.工具类抽取

## 5.SQL注入



























